<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Select Component</title>
    <link href="../assets/css/output.css" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
      .select-content {
        display: none;
      }

      span > i {
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <main class="p-12">
      <section class="grid h-96 place-items-center">
        <div
          id="select-id"
          class="relative w-full gap-2 select"
          data-select-val
        >
          <div
            class="relative flex justify-between w-full overflow-hidden rounded-lg cursor-pointer md:w-52 select-button"
          >
            <div
              class="w-full px-4 py-2 truncate border-l rounded-l-lg border-slate-300 bg-slate-50 border-y"
            >
              <span class="select-display">Choose a staff</span>
            </div>
            <div class="px-4 py-2 rounded-r-lg bg-slate-300 text-slate-50">
              <i class="fa-solid fa-angle-down"></i>
            </div>
          </div>
          <div
            class="absolute z-10 hidden w-full overflow-hidden bg-white border border-gray-300 divide-y divide-gray-300 rounded cursor-pointer h-max md:h-auto md:w-72 md:z-0 select-content"
          >
            <div class="select-accordion" data-is-open="no">
              <div
                class="flex justify-between px-4 py-2 text-sm uppercase bg-slate-100 select-accordion-header"
              >
                <span class="text-slate-500">Admin Registrar</span>
                <span class="select-accordion-state-icon text-slate-500"
                  ><i class="fa-solid fa-plus"></i
                ></span>
              </div>
              <div class="hidden select-accordion-body">
                <div
                  class="flex w-full hover:bg-slate-50 select-accordion-option"
                  data-employee-id="1"
                  data-employee-name="Bemsor Caabay"
                >
                  <div class="px-4 py-2">
                    <i class="fa-solid fa-user"></i>
                  </div>
                  <div class="w-full py-2">
                    <span>Bemsor Caabay</span>
                  </div>
                </div>
                <div
                  class="flex w-full hover:bg-slate-50 select-accordion-option"
                  data-employee-id="2"
                  data-employee-name="Adonis Ampongan"
                >
                  <div class="px-4 py-2">
                    <i class="fa-solid fa-user"></i>
                  </div>
                  <div class="w-full py-2">
                    <span>Adonis Ampongan</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="select-accordion" data-is-open="no">
              <div
                class="flex justify-between px-4 py-2 text-sm uppercase bg-slate-100 select-accordion-header"
              >
                <span class="text-slate-500">DPS</span>
                <span class="select-accordion-state-icon text-slate-500"
                  ><i class="fa-solid fa-plus"></i
                ></span>
              </div>
              <div class="hidden select-accordion-body">
                <div
                  class="flex w-full hover:bg-slate-50 select-accordion-option"
                  data-employee-id="3"
                  data-employee-name="Menchie Lopez"
                >
                  <div class="px-4 py-2">
                    <i class="fa-solid fa-user"></i>
                  </div>
                  <div class="w-full py-2">
                    <span>Menchie Lopez</span>
                  </div>
                </div>
                <div
                  class="flex w-full hover:bg-slate-50 select-accordion-option"
                  data-employee-id="4"
                  data-employee-name="Kristine Martinez"
                >
                  <div class="px-4 py-2">
                    <i class="fa-solid fa-user"></i>
                  </div>
                  <div class="w-full py-2">
                    <span>Kristine Martinez</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="select-accordion" data-is-open="no">
              <div
                class="flex justify-between px-4 py-2 text-sm uppercase bg-slate-100 select-accordion-header"
              >
                <span class="text-slate-500 w">Devs</span>
                <span class="select-accordion-state-icon text-slate-500"
                  ><i class="fa-solid fa-plus"></i
                ></span>
              </div>
              <div class="hidden select-accordion-body">
                <div
                  class="flex w-full hover:bg-slate-50 select-accordion-option"
                  data-employee-id="5"
                  data-employee-name="Uzziel Kyle Ynciong"
                >
                  <div class="px-4 py-2">
                    <i class="fa-solid fa-user"></i>
                  </div>
                  <div class="w-full py-2">
                    <span>Uzziel Kyle Ynciong</span>
                  </div>
                </div>
                <div
                  class="flex w-full hover:bg-slate-50 select-accordion-option"
                  data-employee-id="6"
                  data-employee-name="Jamaica Magbanua"
                >
                  <div class="px-4 py-2">
                    <i class="fa-solid fa-user"></i>
                  </div>
                  <div class="w-full py-2">
                    <span>Jamaica Magbanua</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </body>
  <script>
    $(document).ready(function () {
      function closeAllAccordions() {
        $(".select-accordion").each(function () {
          $(this).data("is-open", "no");
          $(this).find(".select-accordion-body").slideUp(200);
          $(this)
            .find(".select-accordion-state-icon")
            .html('<i class="fa-solid fa-plus"></i>');
        });
      }

      $(".select-button").click(function (event) {
        event.stopPropagation();

        // Close all other select contents
        $(".select-content")
          .not($(this).closest(".select").find(".select-content"))
          .fadeOut(200);
        closeAllAccordions();

        const $selectContent = $(this)
          .closest(".select")
          .find(".select-content");
        const offset = $(this).offset();
        const height = $(this).outerHeight();
        const padding = 12;
        const contentHeight = $selectContent.outerHeight();
        const windowHeight = $(window).height();
        const spaceBelow = windowHeight - (offset.top + height) - padding;

        if (spaceBelow < contentHeight) {
          $selectContent.css({ top: "auto", bottom: height + padding + "px" });
        } else {
          $selectContent.css({ top: height + padding + "px", bottom: "auto" });
        }

        $selectContent.fadeToggle(200, function () {
          if ($(this).is(":hidden")) {
            closeAllAccordions();
          }
        });
      });

      $(".select-accordion-header").click(function () {
        const accordion = $(this).closest(".select-accordion");
        accordion.find(".select-accordion-body").slideToggle(200);

        if (accordion.data("is-open") == "no") {
          accordion.data("is-open", "yes");
          accordion
            .find(".select-accordion-header")
            .find(".select-accordion-state-icon")
            .html('<i class="fa-solid fa-minus"></i>');
        } else {
          accordion.data("is-open", "no");
          accordion
            .find(".select-accordion-header")
            .find(".select-accordion-state-icon")
            .html('<i class="fa-solid fa-plus"></i>');
        }
      });

      $(".select-accordion-option").click(function (event) {
        const employeeId = $(this).data("employee-id");
        const employeeName = $(this).data("employee-name");
        const select = $(this).closest(".select");

        select.data("select-val", employeeId);
        select.find(".select-display").text(employeeName);

        $(this).closest(".select-content").fadeOut(200);
        closeAllAccordions();
      });

      $(window).click(function (event) {
        if (!$(event.target).closest(".select").length) {
          $(".select-content").fadeOut(200, function () {
            closeAllAccordions();
          });
        }
      });

      $(".select-accordion-body").click(function (event) {
        event.stopPropagation();
      });
    });
  </script>
</html>
